# Configurazione del sistema RAG per gestionali
# Copia questo file in .env e personalizza i valori

# Device Configuration (CPU/GPU)
# Valori: "auto" (default, usa GPU se disponibile), "cuda" (forza GPU), "cpu" (forza CPU)
RAG_DEVICE_MODE=auto

# API
RAG_API_HOST=0.0.0.0
RAG_API_PORT=8000
RAG_API_WORKERS=1

# Logging
RAG_LOG_LEVEL=INFO

# Vector Store (Qdrant)
RAG_VECTOR_STORE__HOST=localhost
RAG_VECTOR_STORE__PORT=6333
RAG_VECTOR_STORE__COLLECTION_NAME=gestionale_docs

# Lexical Search (OpenSearch)
RAG_LEXICAL_SEARCH__HOST=localhost
RAG_LEXICAL_SEARCH__PORT=9200
RAG_LEXICAL_SEARCH__INDEX_NAME=gestionale_lexical

# Embeddings
RAG_EMBEDDING__MODEL_NAME=BAAI/bge-m3
RAG_EMBEDDING__BATCH_SIZE=8
RAG_EMBEDDING__BATCH_SIZE_GPU=128

# Retrieval
RAG_RETRIEVAL__K_DENSE=40
RAG_RETRIEVAL__K_LEXICAL=20
RAG_RETRIEVAL__K_FINAL=10

# LLM Configuration (OpenAI) - *** CONFIGURARE OBBLIGATORIAMENTE ***
RAG_LLM__ENABLED=true
RAG_LLM__API_KEY=your-openai-api-key-here
RAG_LLM__MODEL_NAME=gpt-4o-mini
RAG_LLM__TEMPERATURE=0.2
RAG_LLM__MAX_TOKENS=1500
RAG_LLM__MAX_REQUESTS_PER_MINUTE=20

# Generation Settings
RAG_GENERATION__GENERATION_MODE=hybrid
RAG_GENERATION__MAX_CONTEXT_CHUNKS=6
RAG_GENERATION__CITATION_REQUIRED=false

# Domini autorizzati (configurati nel codice per compatibilità)
# RAG_ALLOWED_DOMAINS=["cassiopea.centrosistemi.it","docs.centrosistemi.it"]

# GPU
# Modalità automatica (raccomandato)
# RAG_DEVICE_MODE=auto

# Forza CPU (sviluppo)
RAG_DEVICE_MODE=cpu

# Forza GPU (produzione con GPU garantita)
# RAG_DEVICE_MODE=cuda

# Ottimizzazioni Ingestione (FASE 2 - CPU Optimized)
# Questi parametri risolvono problemi con pagine HTML grosse su CPU
RAG_INGEST__MAX_HTML_SIZE_CHARS=500000
RAG_INGEST__PARSING_TIMEOUT_SECONDS=120
RAG_INGEST__EMBEDDING_TIMEOUT_SECONDS=300
RAG_INGEST__SECTIONS_BATCH_SIZE=15
RAG_INGEST__ENABLE_STREAMING_INGEST=true

# Tuning avanzato per PC con poca RAM o CPU lenta:
# RAG_INGEST__MAX_HTML_SIZE_CHARS=300000
# RAG_INGEST__SECTIONS_BATCH_SIZE=10
# RAG_EMBEDDING__BATCH_SIZE=4

# Tuning per PC più potenti:
# RAG_INGEST__MAX_HTML_SIZE_CHARS=1000000
# RAG_INGEST__SECTIONS_BATCH_SIZE=25
# RAG_EMBEDDING__BATCH_SIZE=16

# Estrazione Immagini (temporaneamente disabilitata per migliorare estrazione testo)
RAG_IMAGE_STORAGE__ENABLED=false
RAG_IMAGE_STORAGE__MIN_WIDTH=100
RAG_IMAGE_STORAGE__MIN_HEIGHT=100

# Per riabilitare le immagini dopo che il testo funziona:
# RAG_IMAGE_STORAGE__ENABLED=true
# RAG_IMAGE_STORAGE__MIN_WIDTH=150
# RAG_IMAGE_STORAGE__MIN_HEIGHT=150