<ng-container *ngIf="sources?.length; else emptyState">
  <mat-accordion class="source-list" multi>
    <mat-expansion-panel *ngFor="let source of sources; index as index">
      <mat-expansion-panel-header>
        <mat-panel-title>
          Fonte {{ index + 1 }} · {{ source.chunk.metadata.title }}
        </mat-panel-title>
        <mat-panel-description>
          Score: {{ source.score | number: '1.3-3' }}
        </mat-panel-description>
      </mat-expansion-panel-header>

      <div class="source-list__metadata">
        <mat-chip-set>
          <mat-chip appearance="outlined" color="primary">
            <mat-icon matChipAvatar>category</mat-icon>
            {{ source.chunk.metadata.module }}
          </mat-chip>
          <mat-chip appearance="outlined">
            <mat-icon matChipAvatar>style</mat-icon>
            {{ source.chunk.metadata.content_type }}
          </mat-chip>
          <mat-chip *ngIf="source.chunk.metadata.version" appearance="outlined">
            <mat-icon matChipAvatar>tag</mat-icon>
            v{{ source.chunk.metadata.version }}
          </mat-chip>
          <mat-chip *ngIf="source.chunk.metadata.param_name" appearance="outlined">
            <mat-icon matChipAvatar>tune</mat-icon>
            {{ source.chunk.metadata.param_name }}
          </mat-chip>
        </mat-chip-set>

        <div class="source-list__links">
          <a
            mat-button
            color="primary"
            [href]="source.chunk.metadata.source_url"
            target="_blank"
            rel="noopener"
          >
            Apri documento
            <mat-icon>open_in_new</mat-icon>
          </a>
        </div>
      </div>

      <div class="source-list__content">
        <h4>Estratto</h4>
        <p>{{ source.chunk.content }}</p>
      </div>
    </mat-expansion-panel>
  </mat-accordion>
</ng-container>

<ng-template #emptyState>
  <div class="source-list__empty">
    <mat-icon>quiz</mat-icon>
    <p>Nessuna fonte disponibile per questa risposta.</p>
  </div>
</ng-template>
